$(function(){App=new(Backbone.View.extend({Server:"",password:"oleoleole",wheel:null,Models:{},Views:{},Collections:{},Vars:{},globalUrl:{},collectionslist:null,idss:[],bellLocation:"Pakistan",el:"body",template:$("#template-app").html(),events:{"click .close":"closeModal"},start:function(){App.Router.PochDB(),this.$el.html(_.template(this.template));var a=$.cookie("Member._id")?!0:!1;App.collectionslist=new App.Collections.listRCollection,App.collectionslist.fetch(),!a&&$.url().attr("fragment")?window.location=$.url().attr("path"):a||$.url().attr("fragment")?a&&!$.url().attr("fragment")?(App.Router.renderNav(),Backbone.history.start({pushState:!1}),Backbone.history.navigate("dashboard",{trigger:!0})):(App.Router.renderNav(),Backbone.history.start({pushState:!1})):(Backbone.history.start({pushState:!1}),Backbone.history.navigate("login",{trigger:!0}))},renderFeedback:function(){var a=new App.Models.report,b=new App.Views.siteFeedback({model:a});b.render(),App.$el.children(".body").append(b.el)},renderRequest:function(a){var b=new App.Views.RequestView;b.type=a,b.render(),App.$el.children(".body").append(b.el),$("#site-request").animate({height:"302px"}),document.getElementById("site-request").style.visibility="visible"},startActivityIndicator:function(){var a=document.getElementById("popup-spinning");null==App.wheel?App.wheel=new Spinner({lines:12,length:20,trail:40,width:5,radius:50,speed:2,color:"#34495E"}).spin(a):App.wheel.spin(a)},stopActivityIndicator:function(){window.setTimeout(function(){document.getElementById("cont").style.visibility="visible",App.wheel.stop()},1e3)},compileManifest:function(a,b){var c={manifestFileURL:"/apps/_design/bell/manifest.default.appcache",updateFileURL:"/apps/_design/bell/update.default.html"},d="{replace me}",e="# Compiled at "+(new Date).getTime()+"\n";App.once("compileManifest:go",function(){_.each(a,function(a,b,c){_.each(a,function(a){e+=encodeURI("/"+b+"/"+a._id)+"\n",_.has(a,"_attachments")&&_.each(a._attachments,function(c,d,f){e+=encodeURI("/"+b+"/"+a._id+"/"+d)+"\n"})})}),App.trigger("compileManifest:replaceTextReady")}),App.once("compileManifest:replaceTextReady",function(){$.get(c.manifestFileURL,function(a){var c=a.replace(d,e);$.getJSON(b,function(a){var d=new XMLHttpRequest;d.open("PUT",b+"/manifest.appcache?rev="+a._rev,!0),d.onload=function(a){App.trigger("compileManifest:compiled")},d.setRequestHeader("Content-type","text/cache-manifest"),d.send(new Blob([c],{type:"text/plain"}))})})}),App.once("compileManifest:compiled",function(){$.get(c.updateFileURL,function(a){transformedUpdateHTML=a.replace("{time}",(new Date).getTime()),$.getJSON(b,function(a){var c=new XMLHttpRequest;c.open("PUT",b+"/update.html?rev="+a._rev,!0),c.onload=function(a){App.trigger("compileManifest:done")},c.setRequestHeader("Content-type","text/html"),c.send(new Blob([transformedUpdateHTML],{type:"text/plain"}))})})}),App.trigger("compileManifest:go")}}))});